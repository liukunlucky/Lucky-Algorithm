export enum DiaryMood {
  EXCELLENT = 'excellent',
  GOOD = 'good',
  NORMAL = 'normal',
  BAD = 'bad',
  TERRIBLE = 'terrible'
}

export class StudyDiaryModel {
  id: number = 0;
  title: string = '';
  content: string = '';
  mood: DiaryMood = DiaryMood.NORMAL;
  studyDuration: number = 0; // å­¦ä¹ æ—¶é•¿ï¼ˆåˆ†é’Ÿï¼‰
  problemsSolved: number = 0; // è§£å†³çš„é¢˜ç›®æ•°é‡
  tags: string = ''; // æ ‡ç­¾ï¼Œç”¨é€—å·åˆ†éš”
  createdAt: string = '';
  updatedAt: string = '';

  constructor() {
    const now = new Date().toISOString();
    this.createdAt = now;
    this.updatedAt = now;
  }

  // è·å–å¿ƒæƒ…æ˜¾ç¤ºæ–‡æœ¬
  getMoodDisplayText(): string {
    switch (this.mood) {
      case DiaryMood.EXCELLENT:
        return 'éå¸¸å¥½';
      case DiaryMood.GOOD:
        return 'è‰¯å¥½';
      case DiaryMood.NORMAL:
        return 'ä¸€èˆ¬';
      case DiaryMood.BAD:
        return 'ä¸å¥½';
      case DiaryMood.TERRIBLE:
        return 'å¾ˆå·®';
      default:
        return 'ä¸€èˆ¬';
    }
  }

  // è·å–å¿ƒæƒ…è¡¨æƒ…
  getMoodEmoji(): string {
    switch (this.mood) {
      case DiaryMood.EXCELLENT:
        return 'ğŸ˜„';
      case DiaryMood.GOOD:
        return 'ğŸ˜Š';
      case DiaryMood.NORMAL:
        return 'ğŸ˜';
      case DiaryMood.BAD:
        return 'ğŸ˜”';
      case DiaryMood.TERRIBLE:
        return 'ğŸ˜¢';
      default:
        return 'ğŸ˜';
    }
  }

  // è·å–å¿ƒæƒ…é¢œè‰²
  getMoodColor(): string {
    switch (this.mood) {
      case DiaryMood.EXCELLENT:
        return '#52c41a';
      case DiaryMood.GOOD:
        return '#1890ff';
      case DiaryMood.NORMAL:
        return '#faad14';
      case DiaryMood.BAD:
        return '#fa8c16';
      case DiaryMood.TERRIBLE:
        return '#f5222d';
      default:
        return '#faad14';
    }
  }

  // è·å–æ ‡ç­¾æ•°ç»„
  getTagsArray(): string[] {
    if (!this.tags) return [];
    return this.tags.split(',').map(tag => tag.trim()).filter(tag => tag.length > 0);
  }

  // è®¾ç½®æ ‡ç­¾æ•°ç»„
  setTagsArray(tags: string[]): void {
    this.tags = tags.join(',');
  }

  // è·å–æ ¼å¼åŒ–çš„åˆ›å»ºæ—¥æœŸ
  getFormattedDate(): string {
    const date = new Date(this.createdAt);
    const year = date.getFullYear();
    const month = String(date.getMonth() + 1).padStart(2, '0');
    const day = String(date.getDate()).padStart(2, '0');
    return `${year}-${month}-${day}`;
  }

  // è·å–æ ¼å¼åŒ–çš„åˆ›å»ºæ—¶é—´
  getFormattedTime(): string {
    const date = new Date(this.createdAt);
    const hours = String(date.getHours()).padStart(2, '0');
    const minutes = String(date.getMinutes()).padStart(2, '0');
    return `${hours}:${minutes}`;
  }

  // è·å–å­¦ä¹ æ—¶é•¿æ˜¾ç¤ºæ–‡æœ¬
  getStudyDurationText(): string {
    if (this.studyDuration < 60) {
      return `${this.studyDuration}åˆ†é’Ÿ`;
    } else {
      const hours = Math.floor(this.studyDuration / 60);
      const minutes = this.studyDuration % 60;
      if (minutes === 0) {
        return `${hours}å°æ—¶`;
      } else {
        return `${hours}å°æ—¶${minutes}åˆ†é’Ÿ`;
      }
    }
  }
}