// æˆå°±ç±»å‹æšä¸¾
export enum AchievementType {
  FIRST_PROBLEM = 'first_problem',           // åˆå‡ºèŒ…åºï¼šå®Œæˆç¬¬ä¸€é“é¢˜ç›®
  CONTINUOUS_DAYS = 'continuous_days',       // æŒä¹‹ä»¥æ’ï¼šè¿ç»­å­¦ä¹ 7å¤©
  PROBLEM_COUNT = 'problem_count',           // é¢˜æµ·æˆ˜æœ¯ï¼šç´¯è®¡å®Œæˆ50é“é¢˜ç›®
  PERFECT_SCORE = 'perfect_score',           // å®Œç¾ä¸»ä¹‰ï¼šè·å¾—10æ¬¡æ»¡åˆ†
  CATEGORY_MASTER = 'category_master',       // åˆ†ç±»å¤§å¸ˆï¼šå®Œæˆæ‰€æœ‰åˆ†ç±»çš„é¢˜ç›®
  SPEED_DEMON = 'speed_demon'                // é€Ÿåº¦ä¹‹ç‹ï¼šå•é¢˜ç”¨æ—¶å°‘äº30ç§’è¾¾åˆ°20æ¬¡
}

// æˆå°±çŠ¶æ€
export interface AchievementStatus {
  type: AchievementType;
  title: string;
  description: string;
  icon: string;
  isCompleted: boolean;
  progress: number;        // å½“å‰è¿›åº¦
  target: number;          // ç›®æ ‡å€¼
  completedAt?: string;    // å®Œæˆæ—¶é—´
}

// æˆå°±æ¨¡å‹
export class AchievementModel {
  type: AchievementType = AchievementType.FIRST_PROBLEM;
  title: string = '';
  description: string = '';
  icon: string = '';
  isCompleted: boolean = false;
  progress: number = 0;
  target: number = 0;
  completedAt?: string;

  constructor() {}

  // è·å–è¿›åº¦ç™¾åˆ†æ¯”
  getProgressPercentage(): number {
    if (this.target === 0) return 0;
    return Math.min(100, Math.round((this.progress / this.target) * 100));
  }

  // è·å–è¿›åº¦æ–‡æœ¬
  getProgressText(): string {
    if (this.isCompleted) {
      return 'å·²å®Œæˆ';
    }
    return `${this.progress}/${this.target}`;
  }

  // é™æ€æ–¹æ³•ï¼šè·å–æ‰€æœ‰æˆå°±å®šä¹‰
  static getAllAchievements(): AchievementModel[] {
    const achievements: AchievementModel[] = [];

    // 1. åˆå‡ºèŒ…åºï¼šå®Œæˆç¬¬ä¸€é“é¢˜ç›®
    const firstProblem = new AchievementModel();
    firstProblem.type = AchievementType.FIRST_PROBLEM;
    firstProblem.title = 'åˆå‡ºèŒ…åº';
    firstProblem.description = 'å®Œæˆç¬¬ä¸€é“é¢˜ç›®';
    firstProblem.icon = 'ğŸŒ±';
    firstProblem.target = 1;
    achievements.push(firstProblem);

    // 2. æŒä¹‹ä»¥æ’ï¼šè¿ç»­å­¦ä¹ 7å¤©
    const continuousDays = new AchievementModel();
    continuousDays.type = AchievementType.CONTINUOUS_DAYS;
    continuousDays.title = 'æŒä¹‹ä»¥æ’';
    continuousDays.description = 'è¿ç»­å­¦ä¹ 7å¤©';
    continuousDays.icon = 'ğŸ”¥';
    continuousDays.target = 7;
    achievements.push(continuousDays);

    // 3. é¢˜æµ·æˆ˜æœ¯ï¼šç´¯è®¡å®Œæˆ50é“é¢˜ç›®
    const problemCount = new AchievementModel();
    problemCount.type = AchievementType.PROBLEM_COUNT;
    problemCount.title = 'é¢˜æµ·æˆ˜æœ¯';
    problemCount.description = 'ç´¯è®¡å®Œæˆ50é“é¢˜ç›®';
    problemCount.icon = 'ğŸ“š';
    problemCount.target = 50;
    achievements.push(problemCount);

    // 4. å®Œç¾ä¸»ä¹‰ï¼šè·å¾—10æ¬¡æ»¡åˆ†
    const perfectScore = new AchievementModel();
    perfectScore.type = AchievementType.PERFECT_SCORE;
    perfectScore.title = 'å®Œç¾ä¸»ä¹‰';
    perfectScore.description = 'è·å¾—10æ¬¡æ»¡åˆ†';
    perfectScore.icon = 'â­';
    perfectScore.target = 10;
    achievements.push(perfectScore);

    // 5. åˆ†ç±»å¤§å¸ˆï¼šå®Œæˆæ‰€æœ‰åˆ†ç±»çš„é¢˜ç›®
    const categoryMaster = new AchievementModel();
    categoryMaster.type = AchievementType.CATEGORY_MASTER;
    categoryMaster.title = 'åˆ†ç±»å¤§å¸ˆ';
    categoryMaster.description = 'å®Œæˆæ‰€æœ‰åˆ†ç±»çš„é¢˜ç›®';
    categoryMaster.icon = 'ğŸ†';
    categoryMaster.target = 8; // å‡è®¾æœ‰8ä¸ªåˆ†ç±»
    achievements.push(categoryMaster);

    // 6. é€Ÿåº¦ä¹‹ç‹ï¼šå•é¢˜ç”¨æ—¶å°‘äº30ç§’è¾¾åˆ°20æ¬¡
    const speedDemon = new AchievementModel();
    speedDemon.type = AchievementType.SPEED_DEMON;
    speedDemon.title = 'é€Ÿåº¦ä¹‹ç‹';
    speedDemon.description = 'å•é¢˜ç”¨æ—¶å°‘äº30ç§’è¾¾åˆ°20æ¬¡';
    speedDemon.icon = 'âš¡';
    speedDemon.target = 20;
    achievements.push(speedDemon);

    return achievements;
  }
}